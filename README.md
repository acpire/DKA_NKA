Задача 1. Слово и ДКА
Имя входного файла: problem1.in
Имя выходного файла: problem1.out
Ограничение по времени: 2 секунды
Ограничение по памяти: 256 мегабайт
Задан детерминированный конечный автомат и слово. Определить, допускает ли данный ДКА
заданное слово.
Формат входного файла
В первой строке входного файла находится слово, состоящее из не более чем 100000 строчных
латинских букв.
Во второй строке содержатся числа n, m и k — количество состояний, переходов и допускающих
состояний в автомате соответственно. (1 6 n, m 6 100000, 1 6 k 6 n).
В следующей строке содержатся k чисел — номера допускающих состояний (состояния
пронумерованы от 1 до n).
В следующих m строках описываются переходы в формате “a b c”, где a — номер исходного
состояния перехода, b — номер состояния, в которое осуществляется переход и c — символ (строчная
латинская буква), по которому осуществляется переход.
Стартовое состояние автомата всегда имеет номер 1. Гарантируется, что из любого состояния не
более одного перехода по каждому символу.

Input

abacaba

2 3 1

2

1 2 a

2 1 b

2 1 c

Output

accepts

Задача 2. Слово и НКА
Имя входного файла: problem2.in
Имя выходного файла: problem2.out
Ограничение по времени: 2 секунды
Ограничение по памяти: 256 мегабайт
Задан недетерминированный конечный автомат и слово. Определить, допускает ли данный НКА
заданное слово.
Формат входного файла
В первой строке входного файла находится слово, состоящее из не более чем 10000 строчных
латинских букв.
Во второй строке содержатся числа n, m и k — количество состояний, переходов и допускающих
состояний в автомате соответственно (1 6 n 6 100, 1 6 m 6 1000, 1 6 k 6 n).
В следующей строке содержатся k чисел — номера допускающих состояний (состояния
пронумерованы от 1 до n).
В следующих m строках описываются переходы в формате “a b c”, где a — номер исходного
состояния перехода, b — номер состояния, в которое осуществляется переход и c — символ (строчная
латинская буква), по которому осуществляется переход.
Стартовое состояние автомата всегда имеет номер 1.

Input 
abacaba

4 6 1

2

1 2 a

2 1 с

2 3 b

3 2 a

2 4 b

1 4 a

Output

accepts

Задача 3. Количество слов в языке
Имя входного файла: problem3.in
Имя выходного файла: problem3.out
Ограничение по времени: 2 секунды
Ограничение по памяти: 256 мегабайт
Задан детерминированный конечный автомат. Требуется определить количество допускаемых
им слов по модулю 109 + 7
Формат входного файла
В первой строке содержатся числа n, m и k — количество состояний, переходов и допускающих
состояний в автомате соответственно (1 6 n, m 6 100000, 1 6 k 6 n).
В следующей строке содержатся k чисел — номера допускающих состояний (состояния
пронумерованы от 1 до n).
В следующих m строках описываются переходы в формате “a b c”, где a — номер исходного
состояния перехода, b — номер состояния, в которое осуществляется переход и c — символ (строчная
латинская буква), по которому осуществляется переход.
Стартовое состояние автомата всегда имеет номер 1. Гарантируется, что из любого состояния не
более одного перехода по каждому символу.

Input 

3 5 1

3

1 2 a

1 2 b

2 3 a

2 3 b

2 3 c

Output

6

Задача 4. Число слов длины l в языке ДКА
Имя входного файла: problem4.in
Имя выходного файла: problem4.out
Ограничение по времени: 2 секунды
Ограничение по памяти: 256 мегабайт
Задан детерминированный конечный автомат и число l. Требуется определить количество
допускаемых им слов длины l по модулю 109 + 7
Формат входного файла
В первой строке содержатся числа n, m, k и l — количество состояний, переходов и допускающих
состояний в автомате, а также длина слов (1 6 n, m 6 100, 1 6 k 6 n, 1 6 l 6 103
).

В следующей строке содержатся k чисел — номера допускающих состояний (состояния
пронумерованы от 1 до n).
В следующих m строках описываются переходы в формате “a b c”, где a — номер исходного
состояния перехода, b — номер состояния, в которое осуществляется переход и c — символ (строчная
латинская буква), по которому осуществляется переход.
Стартовое состояние автомата всегда имеет номер 1. Гарантируется, что из любого состояния не
более одного перехода по каждому символу.

Input

3 6 1 2

3

1 2 a

1 2 b

2 3 a

2 3 b

2 3 c

1 3 q

Output

7

Задача 5. Число слов длины l в языке НКА
Имя входного файла: problem5.in
Имя выходного файла: problem5.out
Ограничение по времени: 2 секунды
Ограничение по памяти: 256 мегабайт
Задан недетерминированный конечный автомат и число l. Требуется определить количество
допускаемых им слов длины l по модулю 109 + 7
Формат входного файла
В первой строке содержатся числа n, m, k и l — количество состояний, переходов и допускающих
состояний в автомате, а также длина слов (1 6 n, m 6 100, 1 6 k 6 n, 1 6 l 6 103
).

В следующей строке содержатся k чисел — номера допускающих состояний (состояния
пронумерованы от 1 до n).
В следующих m строках описываются переходы в формате “a b c”, где a — номер исходного
состояния перехода, b — номер состояния, в которое осуществляется переход и c — символ (строчная
латинская буква), по которому осуществляется переход.
Стартовое состояние автомата всегда имеет номер 1. Гарантируется, что существует
детерминированный автомат, распознающий тот же язык, имеющий не более 100 состояний.

Input

3 6 1 1

3

1 2 a

1 2 b

2 3 a

2 3 b

2 3 c

1 3 q

Output

1
